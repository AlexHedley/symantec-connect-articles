<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="AlexHedley">

  <title>Symantec Connect - ServiceDesk - Could not find work queue item</title>

  <link rel="canonical" href='https://alexhedley.github.io/symantec-connect-articles/posts/servicedesk-could-not-find-work-queue-item'>

      <link type="application/rss+xml" rel="alternate" title="Symantec Connect" href="/symantec-connect-articles/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="Symantec Connect" href="/symantec-connect-articles/feed.atom" />

  <meta name="application-name" content='Symantec Connect' />
  <meta name="msapplication-tooltip" content='Symantec Connect' />
  <meta name="msapplication-starturl" content='/symantec-connect-articles/' />

  <meta property="og:title" content='Symantec Connect - ServiceDesk - Could not find work queue item' />
    <meta property="og:image" content='/symantec-connect-articles/images/header.png' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='https://alexhedley.github.io/symantec-connect-articles/posts/servicedesk-could-not-find-work-queue-item' />

  <link rel="icon" href='/symantec-connect-articles/favicon.ico'>

  <!-- Custom fonts for this template -->
  <link href='/symantec-connect-articles/vendor/fontawesome-free/css/all.min.css' rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" data-no-mirror>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" data-no-mirror>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/symantec-connect-articles/scss/clean-blog.css' rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">

  <link href="/symantec-connect-articles/scss/TabGroup.css" rel="stylesheet" type="text/css">

  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href='/symantec-connect-articles/'>Symantec Connect</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/tags">Tags</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/stats">Stats</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/about">About</a>
  </li>

          <li class="nav-item">
            <span class="nav-link">
              <form class="form-inline my-2 my-lg-0" action="/symantec-connect-articles/search" method="GET">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="query">
                <input type="submit" hidden />
              </form>
            </span>
          </li>
      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  <header class="masthead" style="background-image: url(&quot;/symantec-connect-articles/images/header.png&quot;)">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            ServiceDesk - Could not find work queue item
          </h1>
            <div class="meta">Published on Monday 29 October 2018</div>
              <div class="mt-3">
                  <a href="/symantec-connect-articles/tags/servicedesk" class="badge text-bg-light"> ServiceDesk</a>
              </div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="container">
    <div class="row">
      <div id="content" class="col-md-12">
        <p>You many see the following error message when you try and work a Task against a Ticket.</p>
<ul>
<li>Could not find work queue item</li>
</ul>
<p>This could be due to the fact the server hasn't processed the Tasks in the Messages table.</p>
<pre><code>Error starting/continuing dialog model execution 
System.Exception: could not find work queue item [GUID] the item no longer exists. number of items in queue [#]
at LogicBase.Components.Default.ExchangeAdapters.LogicBaseExchangeWorkQueue.GetItem(String serviceID, String id) 
at LogicBase.Core.Models.Workflow.EmbeddedDialogModel.WorkflowDialogHTTPHandler.StartDialog(HttpContext context, DialogSession session) 
at LogicBase.Core.Models.Dialog.DialogHttpHandlerBase.System.Web.IHttpHandler.ProcessRequest(HttpContext context) 
</code></pre>
<p>Generally, could not find work queue item means something happened with a task message. There are some cases where a message blocks processing but if earlier and later incidents work, that is not the case.</p>
<p>Process information is in ReportProcess table, Task information is in Task table. The state information, variables etc are saved with the message and functional messages are necessary for the task to be workable.</p>
<p>There are normally three messages for a functional Incident, one in each of these queues:</p>
<pre><code>local.workflowsqlexchange-incident_mgmt.processes
local.workflowsqlexchange-incident_mgmt.tasks
local.workflowsqlexchange-incident_mgmt.assignments
</code></pre>
<p><em><strong>.processes</strong></em> is the process data, <em><strong>.tasks</strong></em> is task data, <em><strong>.assignments</strong></em> is task assignment.</p>
<p>Fully finding the root cause is usually not possible but Messages tables are actively updated, having messages from, say, last day could still be in TempDB or transaction logs and be lost when server fails over.</p>
<p>I would first recommend looking for messages associated with affected Task. The following two queries should normally return the same message(s) but in this case might be good idea to run both:</p>
<pre><code>SELECT MessageId, QueueName, MessagePostedDate FROM [Messages]
WHERE MessageID IN (SELECT MessageId FROM MessageProperties
WHERE AttributeCharValue='[TrackingID]')
</code></pre>
<p>Or</p>
<p><img src="images/ServiceDesk_SQL_Messages.png" alt="SQL - Messages" /></p>
<p>Regardless of why exactly this happened, there usually is not much we can do to get these Incidents back. In most cases the messages are gone. If they are there but corrupt, we do not have a good way to repair them.</p>
<p>Resolution is to re-create the affected tickets and close the affected Incidents with Bulk Close/Close Process tool.</p>
<p>To try and find the affected tickets my recommendation is to look for tasks that are not completed, can be completed but do not have a task message.</p>
<p><img src="images/ServiceDesk_SQL_Task.png" alt="SQL - Task" /></p>
<p>I would start with this query. This might need some tweaking to specific situation though.<br />
Please be careful with this last query with regards to performance, it joins Task and Messages tables which are usually large.</p>
<p><a href="https://www.protirus.com/"><img src="images/Protirus.png" alt="Protirus" /></a></p>


        

      </div>
    </div>
  <div id="comments-container" class="row">
    <script src="https://giscus.app/client.js"
        data-repo='alexhedley/symantec-connect-articles'
        data-repo-id='R_kgDOH723Rw'
        data-category-id='DIC_kwDOH723R84CXRav'
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

  </div>
  </div>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">&#xA9; Alex Hedley 2015-2020</p>

        <ul class="list-inline text-center small">
            <li class="list-inline-item">
              <a href="/symantec-connect-articles/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
            </li>
            <li class="list-inline-item">
              <a href="/symantec-connect-articles/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
            </li>
        </ul>
        <br />
        <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src='/symantec-connect-articles/vendor/bootstrap/js/bootstrap.bundle.min.js'></script>
  <script src='/symantec-connect-articles/vendor/startbootstrap-clean-blog/js/scripts.js'></script>
  <script src='/symantec-connect-articles/js/clean-blog.js'></script>
      <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CQV2ZWNX32"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CQV2ZWNX32');
    </script>
  

</body>

</html>
