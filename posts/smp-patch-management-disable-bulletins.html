<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="AlexHedley">

  <title>Alex Hedley - SMP - Patch Management - Disable Bulletins</title>

  <link rel="canonical" href='https://alexhedley.github.io/symantec-connect-articles/posts/smp-patch-management-disable-bulletins'>

      <link type="application/rss+xml" rel="alternate" title="Alex Hedley" href="/symantec-connect-articles/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="Alex Hedley" href="/symantec-connect-articles/feed.atom" />

  <meta name="application-name" content='Alex Hedley' />
  <meta name="msapplication-tooltip" content='Alex Hedley' />
  <meta name="msapplication-starturl" content='/symantec-connect-articles/' />

  <meta property="og:title" content='Alex Hedley - SMP - Patch Management - Disable Bulletins' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='https://alexhedley.github.io/symantec-connect-articles/posts/smp-patch-management-disable-bulletins' />

  <link rel="icon" href='/symantec-connect-articles/favicon.ico'>

  <!-- Custom fonts for this template -->
  <link href='/symantec-connect-articles/vendor/fontawesome-free/css/all.min.css' rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" data-no-mirror>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" data-no-mirror>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/symantec-connect-articles/scss/clean-blog.css' rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">

  <link href="/symantec-connect-articles/scss/TabGroup.css" rel="stylesheet" type="text/css">

  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href='/symantec-connect-articles/'>Alex Hedley</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/tags">Tags</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/about">About</a>
  </li>

      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  <header class="masthead no-image">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            SMP - Patch Management - Disable Bulletins
          </h1>
            <div class="meta">Published on Friday, 2 November 2018</div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="container">
    <div class="row">
      <div id="content" class="col-md-12">
        <h2 id="smp-smp"><img src="images/smp.png" alt="SMP" /> SMP</h2>
<h3 id="patch-management">Patch Management</h3>
<h3 id="disable-bulletins">Disable Bulletins</h3>
<p>Patch Management has it's own Web Service.</p>
<table>
<thead>
<tr>
<th>http://localhost/altiris/patchmanagementcore/PatchWorkflowSvc.asmx</th>
</tr>
</thead>
</table>
<table>
<thead>
<tr>
<th>SMP</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>8.5.3073</td>
<td>✔</td>
</tr>
<tr>
<td>8.1.5844</td>
<td>✘</td>
</tr>
<tr>
<td>7.5.#</td>
<td>✘</td>
</tr>
</tbody>
</table>
<p>Looks like 8.5 got a new method.</p>
<ul>
<li>Disable Bulletins</li>
</ul>
<table>
<thead>
<tr>
<th>http://localhost/altiris/patchmanagementcore/PatchWorkflowSvc.asmx?op=DisableBulletins</th>
</tr>
</thead>
</table>
<p>This takes two parameters</p>
<ul>
<li>bulletinGuids (string)</li>
<li>deletePolicies (boolean)</li>
</ul>
<p>bulletinGuids - This is usually a comma separated list of Guids, when the input is a string but plural.</p>
<hr />
<p>FORUM</p>
<p>Automatically &quot;Delete unused Software Update Packages&quot; problem disabling staged bulletins<br />
<a href="https://www.symantec.com/connect/forums/automatically-delete-unused-software-update-packages-problem-disabling-staged-bulletins">https://www.symantec.com/connect/forums/automatically-delete-unused-software-update-packages-problem-disabling-staged-bulletins</a></p>
<p>From &#64;<a href="https://www.symantec.com/connect/user/sergei-kljujev">Sergei Kljujev</a></p>
<blockquote>
<p>In order to disable Bulletin you can use attached script, as following:</p>
<ol>
<li>Unzip DisableBulletin.zip and copy contents to C:\Program Files\Altiris\Notification Server\Bin.</li>
</ol>
<p>NB! Make Sure to merge NSCRIPT.NRF and NSCRIPT.EXE.CONFIG to the existing ones, if you already have them modified.</p>
<ol start="2">
<li>Run C:\Program Files\Altiris\Notification Server\Bin\NSCRIPT.EXE DisableBulletin.cs &lt;bulletin_guid&gt;</li>
</ol>
<p>Note that the script is working on Patch Management Solution Versions up to 8.1.*</p>
</blockquote>
<ul>
<li><p>DisableBulletin.cs</p>
</li>
<li><p>NScript.exe.config</p>
</li>
<li><p>Nscript.nrf</p>
<p>DisableBulletin.cs</p>
<p>using System;
using System.IO;
using Altiris.NS.ItemManagement;
using Altiris.NS.Security;
using Altiris.PatchManagementCore.Policies;
using Altiris.PatchManagementCore.Resources;</p>
<p>class DisableBulletin
{
static int Main(string[] args)
{
Guid bulletinGuid;
if (args.Length != 1)
{
Console.WriteLine(&quot;Programmatically Disable Bulletin&quot;);
Console.WriteLine(&quot;Usage: nscript.exe DisableBulletin.cs <BulletinGuid>&quot;);
return 1;
}	
if (!Guid.TryParse(args[0], out bulletinGuid))
{
Console.WriteLine(&quot;Error: Cannot create guid from '{0}'&quot;, args[0]);
return 1;
}</p>
<pre><code>      SecurityContextManager.SetContextData();

      var bulletin = Item.GetItem(bulletinGuid, ItemLoadFlags.Writeable) as SoftwareBulletinResource;

      if (bulletin == null)
      {
          Console.WriteLine(&quot;Error: Bulletin '{0}' not found.&quot;, bulletinGuid);
          return 1;
      }	
      var oldValue = bulletin.RaiseMessage;
      try
      {
          bulletin.RaiseMessage = false;
          bulletin.IsDisabledByUser = true;
          bulletin.Enabled = false;
          bulletin.setAdvertStagedState(false);
          bulletin.deleteAllPendingUpdates();
          bulletin.Save();
      } 
      catch (Exception ex)
      {
          Console.WriteLine(&quot;Error: Bulletin '{0}' could not be disabled. Exception: {1}&quot;, bulletin.Name, ex);
         return 1;
      }
      finally 
      {
          bulletin.RaiseMessage = oldValue;
      }

      Console.WriteLine(&quot;Bulletin '{0}' Disabled.&quot;, bulletin.Name);
      return 0;
  }
</code></pre>
<p>}</p>
<p>NScript.exe.config</p>
  <?xml version="1.0" encoding="utf-8"?>
  <!--
  SYMANTEC:     Copyright (c) 2018 Symantec Corporation. All rights reserved.

  THIS SOFTWARE CONTAINS CONFIDENTIAL INFORMATION AND TRADE SECRETS OF SYMANTEC CORPORATION. USE, 
  DISCLOSURE OR REPRODUCTION IS PROHIBITED WITHOUT THE PRIOR EXPRESS WRITTEN PERMISSION OF SYMANTEC
  CORPORATION.

  The Licensed Software and Documentation are deemed to be commercial computer software as defined
  in FAR 12.212 and subject to restricted rights as defined in FAR Section 52.227-19 "Commercial
  Computer Software - Restricted Rights" and DFARS 227.7202, Rights in "Commercial Computer Software
  or Commercial Computer Software Documentation", as applicable, and any successor regulations,
  whether delivered by Symantec as on premises or hosted services.  Any use, modification, reproduction
  release, performance, display or disclosure of the Licensed Software and Documentation by the U.S.
  Government shall be solely in accordance with the terms of this Agreement.
  -->
<p><configuration><runtime>	<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">		<qualifyAssembly partialName="Altiris.Common" fullName="Altiris.Common,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.Common.UI" fullName="Altiris.Common.UI,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.NS" fullName="Altiris.NS,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.NS.StandardItems" fullName="Altiris.NS.StandardItems,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.NS.UI" fullName="Altiris.NS.UI,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.Resource" fullName="Altiris.Resource,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/> 		<qualifyAssembly partialName="Altiris.PatchManagementCore" fullName="Altiris.PatchManagementCore,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.InventoryRuleManagement" fullName="Altiris.InventoryRuleManagement,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>		<qualifyAssembly partialName="Altiris.Resource.UI" fullName="Altiris.Resource.UI,version=7.1.0.0,publicKeyToken=d516cb311cfb6e4f,culture=neutral"/>	</assemblyBinding></runtime>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5.1"/></startup>
</configuration></p>
<p>Nscript.nrf</p>
<p>Altiris.PatchManagementCore
Altiris.InventoryRuleManagement</p>
</li>
</ul>
<hr />
<p>Or from &#64;<a href="https://www.symantec.com/connect/user/schnyders">schnyders</a></p>
<pre><code>$ReportsMS = New-WebServiceProxy -Uri &quot;http://altiris/Altiris/ASDK.NS/ReportManagementService.asmx&quot; -UseDefaultCredential
$ConsoleMS = New-WebServiceProxy -Uri &quot;http://altiris/Altiris/NS/console.asmx&quot; -UseDefaultCredential

$Bulletins = $ReportsMS.RunReport(&quot;9e5b8923-b02b-4702-9b44-4404fa8b6e43&quot;).table | Where-Object { $_.Available_x0020_Packages -gt 0 -and $_.Policies -eq 0 -and $_.Downloaded -eq &quot;Yes&quot; }

ForEach($Bulletin in $Bulletins) {
    $ConsoleMS.ItemCallback($Bulletin._ResourceGuid, &quot;ItemAction:e6e01da7-1f2e-4716-99e0-2738c214d458:&quot;)
}
</code></pre>
<hr />
<p>Programatically disable the staged bulletins<br />
<a href="https://www.symantec.com/connect/forums/programatically-disable-staged-bulletins">https://www.symantec.com/connect/forums/programatically-disable-staged-bulletins</a></p>
<hr />
<p>ALTERNATIVE TOOLS</p>
<p><img src="images/Workflow.png" alt="Worklfow" /> Workflow has it's own Project</p>
<p><strong>Zero Day Patch</strong></p>
<table>
<thead>
<tr>
<th><a href="https://www.symantec.com/connect/videos/workflow-template-zero-day-patch">https://www.symantec.com/connect/videos/workflow-template-zero-day-patch</a></th>
</tr>
</thead>
</table>
<p>This is using a previous version of the WebService but could easily be updated to take advantage of this new method.</p>
<p><strong>AutoPatcher</strong><br />
<a href="https://www.symantec.com/connect/articles/autopatcher">https://www.symantec.com/connect/articles/autopatcher</a></p>
<p><strong> PatchAutomation and ZeroDayPatch builds for 8.0</strong><br />
<a href="https://www.symantec.com/connect/blogs/cwoc-patchautomation-and-zerodaypatch-builds-80">https://www.symantec.com/connect/blogs/cwoc-patchautomation-and-zerodaypatch-builds-80</a></p>
<hr />
<p><a href="https://www.protirus.com/"><img src="images/Protirus.png" alt="Protirus" /></a></p>


        

      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">Copyright &#xA9; 2023</p>

        <ul class="list-inline text-center small">
            <li class="list-inline-item">
              <a href="/symantec-connect-articles/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
            </li>
            <li class="list-inline-item">
              <a href="/symantec-connect-articles/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
            </li>
        </ul>
        <br />
        <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src='/symantec-connect-articles/vendor/bootstrap/js/bootstrap.bundle.min.js'></script>
  <script src='/symantec-connect-articles/vendor/startbootstrap-clean-blog/js/scripts.js'></script>
  <script src='/symantec-connect-articles/js/clean-blog.js'></script>
      <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CQV2ZWNX32"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CQV2ZWNX32');
    </script>
  

</body>

</html>
