<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="AlexHedley">

  <title>Symantec Connect - Workflow - Plugin - Developer Guide - Inspecting</title>

  <link rel="canonical" href='https://alexhedley.github.io/symantec-connect-articles/posts/workflow-plugin-developer-guide-inspecting'>

      <link type="application/rss+xml" rel="alternate" title="Symantec Connect" href="/symantec-connect-articles/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="Symantec Connect" href="/symantec-connect-articles/feed.atom" />

  <meta name="application-name" content='Symantec Connect' />
  <meta name="msapplication-tooltip" content='Symantec Connect' />
  <meta name="msapplication-starturl" content='/symantec-connect-articles/' />

  <meta property="og:title" content='Symantec Connect - Workflow - Plugin - Developer Guide - Inspecting' />
    <meta property="og:image" content='/symantec-connect-articles/images/header.png' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='https://alexhedley.github.io/symantec-connect-articles/posts/workflow-plugin-developer-guide-inspecting' />

  <link rel="icon" href='/symantec-connect-articles/favicon.ico'>

  <!-- Custom fonts for this template -->
  <link href='/symantec-connect-articles/vendor/fontawesome-free/css/all.min.css' rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" data-no-mirror>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" data-no-mirror>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/symantec-connect-articles/scss/clean-blog.css' rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">

  <link href="/symantec-connect-articles/scss/TabGroup.css" rel="stylesheet" type="text/css">

  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href='/symantec-connect-articles/'>Symantec Connect</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/tags">Tags</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/stats">Stats</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/symantec-connect-articles/about">About</a>
  </li>

          <li class="nav-item">
            <span class="nav-link">
              <form class="form-inline my-2 my-lg-0" action="/symantec-connect-articles/search" method="GET">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="query">
                <input type="submit" hidden />
              </form>
            </span>
          </li>
      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  <header class="masthead" style="background-image: url(&quot;/symantec-connect-articles/images/header.png&quot;)">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            Workflow - Plugin - Developer Guide - Inspecting
          </h1>
            <div class="meta">Published on Friday, 19 May 2017</div>
              <div class="mt-3">
                  <a href="/symantec-connect-articles/tags/workflow" class="badge text-bg-light"> Workflow</a>
                  <a href="/symantec-connect-articles/tags/plugin" class="badge text-bg-light"> Plugin</a>
                  <a href="/symantec-connect-articles/tags/developer-guide" class="badge text-bg-light"> Developer Guide</a>
              </div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="container">
    <div class="row">
      <div id="content" class="col-md-12">
        <p>In this Article I'm going to explain how to inspect other Plugins to learn how to implement items that aren't in the Developer Guide PDF.</p>
<p>Table of Contents</p>
<ul>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=016f70af-1c51-438b-bbae-f98e86164f26&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">List</a></li>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=84ee5f15-df6c-44c7-8acd-e2764f0c4717&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">Setup</a></li>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=8aeca32a-9a00-4d91-b618-f6af07957e71&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">Simple Plugin</a></li>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=2e508788-3a83-4a91-8e5b-18b28ca1cc02&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">Deploy</a></li>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=5076bfd9-0b26-408c-b957-3bb5fb0b59c2&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">Advanced Plugin</a></li>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=6d54d145-537c-40e6-86ca-b5dec2b1e972&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">Inspecting</a> (this)</li>
<li><a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=80b95a29-8a1a-44ce-a616-87cf8e001dbd&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">WindowsForm</a></li>
</ul>
<p>There are a number of decompilers available</p>
<ul>
<li><img src="images/JustDecompile.png" alt="JustDecompile" /> <a href="http://www.telerik.com/products/decompiler.aspx">JustDecompile</a> from <a href="http://www.telerik.com/">Telerik</a></li>
<li><img src="images/dotPeekS.png" alt="dotPeek (S)" /> <a href="https://www.jetbrains.com/decompiler/">dotPeek</a> from <img src="images/JetBrainsS.png" alt="JetBrains (S)" /> <a href="https://www.jetbrains.com/">JetBrains</a></li>
<li><a href="http://ilspy.net/">ILSpy</a></li>
</ul>
<p>We need some Plugins to look at, grab them from the folder you deploy yours too.</p>
<blockquote>
<p>[Install Drive]:\Program Files\Symantec\Workflow\Designer\Plugins</p>
</blockquote>
<p>There are a number to choose from, firstly we will look at <a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=0cb4ba5b-6f4b-4fe8-bc05-a16971bd1f5d&amp;CommunityKey=04ead5e9-3643-4118-b853-afa5a58710c6&amp;tab=librarydocuments">Create GUID</a>.</p>
<pre><code>LogicBase.Plugins.CreateGUID.dll
</code></pre>
<p>Open</p>
<ul>
<li><em>GUIDPlugIn.cs</em></li>
</ul>
<p>The main difference here is in the <em>PerformAction</em> method.</p>
<pre><code>public void PerformAction(AbstractOrchestrationProject project)
{
    GUIDForm gUIDForm = new GUIDForm();
    if (gUIDForm.ShowDialog() == DialogResult.OK)
    {
        string guid = gUIDForm.Guid;
        ActionType selectedAction = gUIDForm.SelectedAction;
        if (selectedAction == ActionType.CreateAsDataComponent)
        {
            IComponentModel primaryComponentModel = project.GetPrimaryComponentModel();
            InsertDataComponent insertDataComponent = new InsertDataComponent();
            insertDataComponent.set_DataType(typeof(string));
            insertDataComponent.set_IsArray(false);
            insertDataComponent.set_Value(guid);
            insertDataComponent.Location = new PointF(20f, 20f);
            primaryComponentModel.AddComponent(insertDataComponent);
            return;
        }
        if (selectedAction == ActionType.CopyToClipboard)
        {
            Clipboard.SetDataObject(guid, true);
        }
    }
}
</code></pre>
<p>In Workflow Manager click on the Menu - Plugins | Create GUID</p>
<p><img src="images/Workflow-Menu-Plugins-CreateGUID.png" alt="Workflow - Menu - Plugins - Create GUID" /></p>
<p>This opens a Form and depending on the chosen action it does either of two things.</p>
<table>
<thead>
<tr>
<th>BUG: This states &quot;current model&quot; but actually puts it into the <img src="images/Model1.png" alt="Model 1" /> Primary model.</th>
</tr>
</thead>
</table>
<p>If we look at the code it's asking for the Primary.</p>
<pre><code>IComponentModel primaryComponentModel = project.GetPrimaryComponentModel();
</code></pre>
<p>Or saving to the Clipboard</p>
<pre><code>Clipboard.SetDataObject(guid, true);
</code></pre>
<p>If you want to work with Components you will need to add a ref.</p>
<pre><code>using LogicBase.Components.Default.Process;
</code></pre>
<p>Find the component you want to work with and set the desired properties.</p>
<p>Custom Form</p>
<p>You can create a WinForms Form and design it how you would any C# project.</p>
<p>As you can see from the above code just create an instance and use how you would normally, nothing specific to WF.</p>
<hr />
<p>You can try creating a Project from the DLL (using <img src="images/JustDecompile.png" alt="JustDecompile" /> JustDecompile) but I've had issues getting this to work.</p>
<p><img src="images/JustDecompile-Project-RightClick.png" alt="JustDecompile-Project-RightClick" /></p>
<p>(load failed)</p>
<blockquote>
<p>E:\WF\LogicBase.Plugins.CreateGUID\LogicBase.Plugins.CreateGUID.csproj : error  : The project file could not be loaded. Data at the root level is invalid. Line 1, position 1.  E:\WF\LogicBase.Plugins.CreateGUID\LogicBase.Plugins.CreateGUID.csproj</p>
</blockquote>
<p>If you look at the .csproj in notepad there is an object ref error.</p>
<p>If you copy another blank projects .csproj, rename it to this Project name you can play about with some files to make it work, add Existing Items and pull in the files that were created.</p>
<hr />
<p><img src="images/Protirus.png" alt="Protirus" /></p>


        

      </div>
    </div>
  <div id="comments-container" class="row">
    <script src="https://giscus.app/client.js"
        data-repo='alexhedley/symantec-connect-articles'
        data-repo-id='R_kgDOH723Rw'
        data-category-id='DIC_kwDOH723R84CXRav'
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

  </div>
  </div>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">&#xA9; Alex Hedley 2015-2020</p>

        <ul class="list-inline text-center small">
            <li class="list-inline-item">
              <a href="/symantec-connect-articles/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
            </li>
            <li class="list-inline-item">
              <a href="/symantec-connect-articles/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
            </li>
        </ul>
        <br />
        <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src='/symantec-connect-articles/vendor/bootstrap/js/bootstrap.bundle.min.js'></script>
  <script src='/symantec-connect-articles/vendor/startbootstrap-clean-blog/js/scripts.js'></script>
  <script src='/symantec-connect-articles/js/clean-blog.js'></script>
      <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CQV2ZWNX32"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CQV2ZWNX32');
    </script>
  

</body>

</html>
